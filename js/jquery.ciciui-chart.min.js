/**
 * CiCiUI Chart v1.0.0
 * http://ciciui.com/chart/index.html
 * ===================== Free (Non-Commercial) License ==========================
 * For non-commercial, personal projects and applications, you may use CiCiUI
 * Chart under the terms of the MIT License. You may use CiCiUI Chart for free.
 * ===================== Commercial License =====================================
 * This is the appropriate option if you want to use CiCiUI Chart to develop commercial
 * websites or applications. Please refer to the following link for more details
 * http://ciciui.com/chart/purchase.html
 *
 * Copyright 2013 CiCiUI
 */
(function(e){function g(e,t){var n=Math.abs(e/t),r={stepSize:0,decimalFix:0};if(n==0)return r;if(n<1){function i(e){return e*=10,r.decimalFix++,e>1?Math.ceil(e)/10:i(e)/10}r.stepSize=i(n)}else if(n<5)r.stepSize=Math.ceil(n);else{function s(e){return e/10<10?10:s(e/10)*10}var o=s(n)/2;n=Math.ceil(n/o)*o,r.stepSize=n}return r}function y(t,n){return e.extend({},t,n)}function b(e,t){var n,r,i,s=t/e,o=~~(s*6),u=s*6-o,a=1-u;switch(o%6){case 0:n=1,r=u,i=0;break;case 1:n=a,r=1,i=0;break;case 2:n=0,r=1,i=u;break;case 3:n=0,r=a,i=1;break;case 4:n=u,r=0,i=1;break;case 5:n=1,r=0,i=a}var f="#"+("00"+(~~(n*255)).toString(16)).slice(-2)+("00"+(~~(r*255)).toString(16)).slice(-2)+("00"+(~~(i*255)).toString(16)).slice(-2);return f}function w(e,t){var n=[],r;for(var i=0;i<e.length;i++)r=e[i],n.push("rgba("+parseInt(r.substr(1,2),16)+","+parseInt(r.substr(3,2),16)+","+parseInt(r.substr(5,2),16)+","+t+")");return n}function x(e){if(e<=E.length)return E.slice(0,e);var t=[];for(var n=0;n<e;n++)t.push(b(e,n));return t}function T(e){if(e<=S.length)return S.slice(0,e);var t=[];for(var n=0;n<e;n++)t.push(b(e,n));return w(t,.5)}function N(e,t,n){var r=0;for(var i=0;i<e.length;i++){var s=t.measureText(e[i]+"XX").width;s>r&&(r=s)}return r+n}function C(e,t,n,r){var i,s,o,u,a,f,l;return a=Math.min.apply(Math,n),f=Math.max.apply(Math,n),a>0?(o=g(f,e),s=o.stepSize*e,i=0,l=r.measureText(s+"XX").width):f<0?(s=0,o=g(a,e),i=-o.stepSize*e,l=r.measureText(i+"XX").width):(o=g(Math.max(Math.abs(a),f),e/2),s=o.stepSize*e/2,i=-s,l=r.measureText(i+"XX").width),u=t/e,{start:i,end:s,stepSize:o.stepSize,stepFix:o.decimalFix,stepLength:u,rangeTextWidth:l}}function k(t,n){function r(r,i){this.each(function(s,o){new t(o,e(this).width(),e(this).height(),r,i,n)})}return r}Number.prototype.toFixed||(Number.prototype.toFixed=function(e){var t=Math.pow(10,e||0);return String(Math.round(this*t)/t)});var t={bgFillColor:"#FFF",fontFamily:"serif, sans-serif, monospace",fontSize:10,fontColor:"#000"},n=e.extend({},t,{gridStrokeColor:"rgba(0, 0, 0, .3)",numberCoordinateCount:8}),r=e.extend({},t),i=e.extend({},t,{circleColor:"rgba(0, 0, 0, .2)",circleCount:8}),s=e.extend({},t,{holeRadiusFactor:.3}),o=e.extend({},t,{gridStrokeColor:"rgba(0, 0, 0, .3)",numberCoordinateCount:8,circleRadius:3}),u=e.extend({},t,{webGridStrokeColor:"rgba(0, 0, 0, .2)",webGridCount:4,lineWidth:2}),a=function(t,n,r,i,s,o){if(t===undefined)return;e(t).addClass("ciciui-chart"),this.canvasDiv=t,this.width=n,this.height=r,this.dataSheet=i;var u=e("<canvas>").attr({width:n,height:r}).css({position:"absolute",top:0,left:0}).addClass("canvas").appendTo(t)[0];this.tooltipDiv=e('<div class="chart-tooltip"></div>').appendTo(t).hide()[0];var a=e("<canvas>").attr({width:n,height:r}).css({position:"absolute",top:0,left:0}).addClass("mask").appendTo(t)[0];e(a).mouseenter(e.proxy(this.onMouseEnter,this)).mousemove(e.proxy(this.onMouseMove,this)).mouseout(e.proxy(this.onMouseOut,this)),u.getContext||(G_vmlCanvasManager.initElement(u),G_vmlCanvasManager.initElement(a));var f=this.ctx=u.getContext("2d");this.config=y(o,s),f.font=[this.config.fontSize+"pt",this.config.fontFamily].join(" "),this.singleCharWidth=f.measureText("X").width,this.fillBackground(),this.elementInfo={elements:[]},this.draw(i,n,r,this.ctx)};a.prototype.fillBackground=function(){this.ctx.fillStyle=this.config.bgFillColor,this.ctx.fillRect(0,0,this.width,this.height)},a.prototype.onMouseEnter=function(){e(this.tooltipDiv).css({position:"absolute"}).show()},a.prototype.onMouseMove=function(t){var n=e(this.canvasDiv).offset(),r=this.findHoverElement(t.pageX-n.left,t.pageY-n.top);r&&this.showTooltip(r)},a.prototype.onMouseOut=function(){e(this.tooltipDiv).hide()},a.prototype.drawHeaderIndicator=function(e,t,n){var r=this.config.fontSize,i=n.x+r+this.singleCharWidth;for(var s=0;s<e.length;s++)this.ctx.fillStyle=t[s],this.ctx.fillRect(n.x+this.singleCharWidth,s*this.config.fontSize*2+n.y,r,r),this.ctx.fillStyle=this.config.fontColor,this.ctx.fillText(e[s],i,s*this.config.fontSize*2+this.config.fontSize+n.y)},a.prototype.drawTitle=function(e){if(!this.config.title)return;var t=this.ctx;t.font=["bold",this.config.fontSize*2+"pt",this.config.fontFamily].join(" ");var n=t.measureText(this.config.title).width;t.fillText(this.config.title,e.x+e.width/2-n/2,e.y+e.height/2+this.config.fontSize),t.font=this.config.font},a.prototype.calculateTooltipPosition=function(t,n){var r=e(this.tooltipDiv).width(),i=e(this.tooltipDiv).height();return t<0?t=0:t+i>this.height&&(t=this.height-i),n<0?n=0:n+r>this.width&&(n=this.width-r),{top:t,left:n}};var f=function(e,t,n,r,i,s){if(e===undefined)return;i&&i.numberCoordinateCount&&(i.numberCoordinateCount=Math.ceil(i.numberCoordinateCount/2)*2),a.call(this,e,t,n,r,i,s)};f.prototype=new a,f.prototype.constructor=f,f.prototype.calculateRange=function(e){var t=[],n,r;for(n=1;n<this.dataSheet.length;n++){var i=this.dataSheet[n];for(r=1;r<i.length;r++)t.push(i[r])}return C(this.config.numberCoordinateCount,e,t,this.ctx)};var l=function(e,t,n,r,i,s){f.call(this,e,t,n,r,i,s)};l.prototype=new f,l.prototype.constructor=l,l.prototype.draw=function(e,t,n,r){var i=this.config,s=[],o,u;for(o=0;o<e.length;o++)s.push(e[o][0]);var a=i.fontSize*2,f={x:0,y:0,width:t,height:i.title?a*2:i.fontSize},l={x:0,y:n-a,width:t,height:a},c={x:0,y:f.y+f.height,width:N(s,r,i.fontSize),height:n-l.height-f.height},h=N(e[0].slice(1),r,i.fontSize),p={x:t-h,y:f.y+f.height,width:h,height:n-l.height-f.height},d={x:c.x+c.width,y:f.y+f.height,width:t-c.width-p.width,height:n-f.height-l.height},v;if(i.type&&i.type==="stacked"){var m=[],g,y;for(o=1;o<e.length;o++){g=0,y=e[o];for(u=1;u<y.length;u++)g+=y[u];m.push(g)}v=C(i.numberCoordinateCount,d.width,m,r)}else v=this.calculateRange(d.width);var b=0;r.beginPath(),r.strokeStyle=i.gridStrokeColor;for(o=0;o<=i.numberCoordinateCount;o++){var w=v.start+o*v.stepSize,E=d.x+o*v.stepLength+.5;w==0?b=E:(r.moveTo(Math.floor(E)+.5,d.y),r.lineTo(Math.floor(E)+.5,d.y+d.height)),r.fillStyle=i.fontColor;var S=w.toFixed(v.stepFix);parseFloat(S)===0&&(S="0"),r.fillText(S,E-r.measureText(S).width/2,l.y+a)}r.stroke(),r.beginPath(),r.strokeStyle="#000",r.moveTo(Math.floor(b)+.5,d.y),r.lineTo(Math.floor(b)+.5,d.y+d.height),r.stroke();var T=d.height/(e.length-1),k=T/8,L=e[0].length-1,A=x(L),O;i.type&&i.type.toLowerCase()=="stacked"?O=T-k*2:O=(T-k*2)/L;for(o=1;o<e.length;o++){var M=e[o],_,D=0;r.fillStyle=i.fontColor,r.fillText(M[0],c.x,d.y+(o-.5)*T);for(u=1;u<M.length;u++){_=v.stepLength/v.stepSize*M[u];if(i.type&&i.type.toLowerCase()=="stacked"){var P=v.stepLength/v.stepSize*D+b;D+=M[u],this.drawRectBar(P,d.y+(o-1)*T+k,_,O,A[u-1],M[0],e[0][u],M[u])}else this.drawRectBar(b,d.y+(o-1)*T+k+(u-1)*O,_,O,A[u-1],M[0],e[0][u],M[u])}}this.drawHeaderIndicator(e[0].slice(1),A,p),this.drawTitle(f)},l.prototype.findHoverElement=function(e,t){var n,r;for(r=0;r<this.elementInfo.elements.length;r++){n=this.elementInfo.elements[r];if(n.width<0){if(e<n.x&&e>=n.x+n.width&&t>=n.y&&t<n.y+n.height)return n}else if(e>=n.x&&e<n.x+n.width&&t>=n.y&&t<n.y+n.height)return n}return null},l.prototype.showTooltip=function(t){var n=t.y+(t.height<0?10:-e(this.tooltipDiv).height()-10),r=t.x+t.width,i;e(this.tooltipDiv).html('<p class="desc">'+t.label+'<br /><a style="color:'+t.color+'">'+t.header+": </a>"+t.value+"</p>"),i=this.calculateTooltipPosition(n,r),e(this.tooltipDiv).css({top:i.top,left:i.left}).show()},l.prototype.drawRectBar=function(e,t,n,r,i,s,o,u){this.ctx.fillStyle=i,this.ctx.fillRect(e,t,n,r),this.elementInfo.elements.push({x:e,y:t,width:n,height:r,color:i,label:s,header:o,value:u})};var c=function(e,t,n,r,i,s){f.call(this,e,t,n,r,i,s)};c.prototype=new f,c.prototype.constructor=c,c.prototype.draw=function(e,t,n,r){var i=this.config.fontSize*2,s={x:0,y:n-i,width:t,height:i},o={x:0,y:0,width:t,height:this.config.title?i*2:this.config.fontSize},u=this.calculateRange(n-o.height-s.height),a={x:0,y:o.y+o.height,width:u.rangeTextWidth,height:n-s.height-o.height},f=N(e[0].slice(1),r,this.config.fontSize),l={x:t-f,y:o.y+o.height,width:f,height:n-s.height-o.height},c={x:a.x+a.width,y:o.y+o.height,width:t-a.width-l.width,height:n-a.height-o.height},h=0;r.beginPath(),r.strokeStyle=this.config.gridStrokeColor;for(var p=0;p<=this.config.numberCoordinateCount;p++){var d=u.start+p*u.stepSize,v=a.y+a.height-p*u.stepLength+.5;d==0?h=v:(r.moveTo(c.x,Math.floor(v)+.5),r.lineTo(c.x+c.width,Math.floor(v)+.5)),r.fillStyle=this.config.fontColor,r.fillText(d.toFixed(u.stepFix),a.x,v+this.config.fontSize/2)}r.stroke(),r.beginPath(),r.fillStyle="#000",r.strokeStyle="#000",r.moveTo(c.x,Math.floor(h)+.5),r.lineTo(c.x+c.width,Math.floor(h)+.5),r.stroke();var m=c.width/(e.length-1),g=m/8,y=e[0].length-1,b=(m-g*2)/y,w=x(y);for(p=1;p<e.length;p++){var E=e[p];r.fillStyle=this.config.fontColor,r.fillText(E[0],c.x+(p-.5)*m-r.measureText(E[0]).width/2,s.y+s.height*.75);for(var S=1;S<E.length;S++){var T=u.stepLength/u.stepSize*E[S];this.drawRectBar(c.x+(p-1)*m+g+(S-1)*b,h-T,b,T,w[S-1],E[0],e[0][S],E[S])}}this.drawHeaderIndicator(e[0].slice(1),w,l),this.drawTitle(o)},c.prototype.showTooltip=function(t){var n=t.y+(t.height<0?10:-e(this.tooltipDiv).height()-10),r=t.x,i;e(this.tooltipDiv).html('<p class="desc">'+t.label+'<br /><a style="color:'+t.color+'">'+t.header+": </a>"+t.value+"</p>"),i=this.calculateTooltipPosition(n,r),e(this.tooltipDiv).css({top:i.top,left:i.left}).show()},c.prototype.findHoverElement=function(e,t){var n,r;for(r=0;r<this.elementInfo.elements.length;r++){n=this.elementInfo.elements[r];if(n.height<0){if(e>=n.x&&e<n.x+n.width&&t<n.y&&t>=n.y+n.height)return n}else if(e>=n.x&&e<n.x+n.width&&t>=n.y&&t<n.y+n.height)return n}return null},c.prototype.drawRectBar=function(e,t,n,r,i,s,o,u){this.ctx.fillStyle=i,this.ctx.fillRect(e,t,n,r),this.elementInfo.elements.push({x:e,y:t,width:n,height:r,color:i,label:s,header:o,value:u})};var h=function(e,t,n,r,i,s){a.call(this,e,t,n,r,i,s)};h.prototype=new a,h.prototype.constructor=h,h.prototype.showTooltip=function(t){var n=(t.start+t.end)/2,r=this.elementInfo.x+Math.cos(n)*this.elementInfo.radius,i=this.elementInfo.y+Math.sin(n)*this.elementInfo.radius,s;e(this.tooltipDiv).html('<p class="desc">'+t.label+"<br />"+t.header+': <a style="color:'+t.color+'">'+t.value+"</a>("+t.percentage*100+"%)</p>"),i-=i<this.elementInfo.y?e(this.tooltipDiv).height():0,r-=r<this.elementInfo.x?e(this.tooltipDiv).width():0,s=this.calculateTooltipPosition(i,r),e(this.tooltipDiv).css({top:s.top,left:s.left}).show()},h.prototype.draw=function(t,n,r,i){var s={x:0,y:0,width:n,height:this.config.title?this.config.fontSize*4:this.config.fontSize},o=e.map(t.slice(1),function(e){return e[0]}),u=N(o,i,this.config.fontSize),a={x:n-u,y:s.y+s.height,width:u,height:r-s.height},f={x:0,y:s.y+s.height,width:n-a.width,height:r-s.height},l=x(o.length);this.elementInfo.x=f.x+f.width/2,this.elementInfo.y=f.y+f.height/2,this.elementInfo.radius=Math.min(f.width,f.height)/2*.9;var c=0,h,p=0;for(h=1;h<t.length;h++)c+=t[h][1];i.save(),i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=8,i.shadowColor="rgba(0, 0, 0, 0.5)";for(h=1;h<t.length;h++)this.drawArcs(p/c*2*Math.PI,(p+t[h][1])/c*2*Math.PI,l[h-1],t[0][1],t[h][0],t[h][1]),p+=t[h][1];i.restore(),this.drawHeaderIndicator(o,l,a),this.drawTitle(s)},h.prototype.drawArcs=function(e,t,n,r,i,s){this.ctx.beginPath(),this.ctx.fillStyle=n,this.ctx.moveTo(this.elementInfo.x,this.elementInfo.y),this.ctx.arc(this.elementInfo.x,this.elementInfo.y,this.elementInfo.radius,e,t,!1),this.ctx.lineTo(this.elementInfo.x,this.elementInfo.y),this.ctx.closePath(),this.ctx.fill(),this.elementInfo.elements.push({start:e,end:t,color:n,header:r,label:i,value:s,percentage:((t-e)/(2*Math.PI)).toFixed(2)})},h.prototype.findHoverElement=function(e,t){var n=Math.sqrt(Math.pow(e-this.elementInfo.x,2)+Math.pow(t-this.elementInfo.y,2));if(n<=this.elementInfo.radius){var r=Math.atan2(e-this.elementInfo.x,t-this.elementInfo.y);r=Math.PI*.5-r,r<0&&(r=Math.PI*2+r);for(var i=0;i<this.elementInfo.elements.length;i++){var s=this.elementInfo.elements[i];if(r>=s.start&&r<s.end)return s}}return null};var p=function(e,t,n,r,i,s){a.call(this,e,t,n,r,i,s)};p.prototype=new a,p.prototype.constructor=p,p.prototype.draw=function(t,n,r,i){var s={x:0,y:0,width:n,height:this.config.fontSize*(this.config.title?4:1)},o=e.map(t.slice(1),function(e){return e[0]}),u=N(o,i,this.config.fontSize),a={x:n-u,y:s.y+s.height,width:u,height:r-s.height},f={x:0,y:s.y+s.height,width:n-a.width,height:r-s.height},l=x(o.length);this.elementInfo.x=f.x+f.width/2,this.elementInfo.y=f.y+f.height/2,this.elementInfo.radius=Math.min(f.width,f.height)/2*.96,this.elementInfo.holeRadius=this.elementInfo.radius*this.config.holeRadiusFactor;var c=[],h,p,d=0,v=t[0].slice(1),m=(this.elementInfo.radius-this.elementInfo.holeRadius)/v.length,g=this.elementInfo.radius,y=g-m;for(h=0;h<v.length;h++){d=0;for(p=1;p<t.length;p++)d+=t[p][h+1];c.push(d)}i.save(),i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=8,i.shadowColor="rgba(0, 0, 0, 0.5)";for(h=v.length-1;h>=0;h--){d=0;for(p=1;p<t.length;p++)this.drawArcs(d/c[h]*2*Math.PI,(d+t[p][h+1])/c[h]*2*Math.PI,y,g,l[p-1],v[h],t[p][0],t[p][h+1]),d+=t[p][h+1];g=y,y-=m}i.beginPath(),i.moveTo(this.elementInfo.x,this.elementInfo.y),i.fillStyle=this.config.bgFillColor,i.arc(this.elementInfo.x,this.elementInfo.y,g,0,Math.PI*2,!1),i.closePath(),i.fill(),i.restore(),this.drawHeaderIndicator(o,l,a),this.drawTitle(s)},p.prototype.drawArcs=function(e,t,n,r,i,s,o,u){var a=this.ctx;a.beginPath(),a.fillStyle=i,a.moveTo(this.elementInfo.x,this.elementInfo.y),a.arc(this.elementInfo.x,this.elementInfo.y,r,e,t,!1),a.lineTo(this.elementInfo.x,this.elementInfo.y),a.closePath(),a.fill(),this.elementInfo.elements.push({start:e,end:t,startR:n,endR:r,color:i,header:s,label:o,value:u,percentage:((t-e)/(2*Math.PI)).toFixed(2)})},p.prototype.findHoverElement=function(e,t){var n=Math.sqrt(Math.pow(e-this.elementInfo.x,2)+Math.pow(t-this.elementInfo.y,2));if(n<=this.elementInfo.radius&&n>this.elementInfo.holeRadius){var r=Math.atan2(e-this.elementInfo.x,t-this.elementInfo.y);r=Math.PI*.5-r,r<0&&(r=Math.PI*2+r);for(var i=0;i<this.elementInfo.elements.length;i++){var s=this.elementInfo.elements[i];if(n>s.endR||n<s.startR)continue;if(r>=s.start&&r<s.end)return s}}return null},p.prototype.showTooltip=function(t){var n=(t.start+t.end)/2,r=this.elementInfo.x+Math.cos(n)*t.endR,i=this.elementInfo.y+Math.sin(n)*t.endR,s;e(this.tooltipDiv).html('<p class="desc">'+t.label+"<br />"+t.header+': <a style="color:'+t.color+'">'+t.value+"</a>("+t.percentage*100+"%)</p>"),i-=i<this.elementInfo.y?e(this.tooltipDiv).height():0,r-=r<this.elementInfo.x?e(this.tooltipDiv).width():0,s=this.calculateTooltipPosition(i,r),e(this.tooltipDiv).css({top:s.top,left:s.left}).show()};var d=function(e,t,n,r,i,s){i&&i.circleCount&&(i.circleCount=Math.ceil(i.circleCount/2)*2),a.call(this,e,t,n,r,i,s)};d.prototype=new a,d.prototype.constructor=d,d.prototype.draw=function(t,n,r,i){var s={x:0,y:0,width:n,height:this.config.fontSize*(this.config.title?4:1)},o=e.map(t.slice(1),function(e){return e[0]}),u=N(o,i,this.config.fontSize),a={x:n-u,y:s.y+s.height,width:u,height:r-s.height},f={x:0,y:s.y+s.height,width:n-a.width,height:r-s.height},l=x(o.length);this.elementInfo.x=Math.floor(f.x+f.width/2)+.5,this.elementInfo.y=Math.floor(f.y+f.height/2)+.5;var c=Math.floor(Math.min(f.height*.9,f.width*.9)/2),h=[],p,d;for(p=1;p<this.dataSheet.length;p++){var v=this.dataSheet[p];for(d=1;d<v.length;d++)h.push(v[d])}var m=C(this.config.circleCount,c,h,i),g=this.dataSheet.length-1,y=Math.PI*2/g,b,w,E;i.strokeStyle=this.config.circleColor;for(p=0;p<this.config.circleCount;p++)i.beginPath(),i.arc(this.elementInfo.x,this.elementInfo.y,m.stepLength*(p+1),0,Math.PI*2,!0),i.stroke();i.save(),i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=8,i.shadowColor="rgba(0, 0, 0, 0.5)";for(p=0;p<g;p++)b=p*y,w=(p+1)*y,E=this.dataSheet[p+1][1]/m.stepSize*m.stepLength,this.elementInfo.elements.push({start:b,end:w,r:E,label:this.dataSheet[p+1][0],value:this.dataSheet[p+1][1],color:l[p]}),i.fillStyle=l[p],i.beginPath(),i.arc(this.elementInfo.x,this.elementInfo.y,E,b,w,!1),i.lineTo(this.elementInfo.x,this.elementInfo.y),i.closePath(),i.fill();i.restore(),this.drawHeaderIndicator(o,l,a),this.drawTitle(s)},d.prototype.showTooltip=function(t){var n=(t.start+t.end)/2,r=this.elementInfo.x+Math.cos(n)*t.r,i=this.elementInfo.y+Math.sin(n)*t.r,s;e(this.tooltipDiv).html('<p class="desc">'+t.label+'<br /><a style="color:'+t.color+'">'+t.value+"</a></p>"),i-=i<this.elementInfo.y?e(this.tooltipDiv).height():0,r-=r<this.elementInfo.x?e(this.tooltipDiv).width():0,s=this.calculateTooltipPosition(i,r),e(this.tooltipDiv).css({top:s.top,left:s.left}).show()},d.prototype.findHoverElement=function(e,t){var n=Math.sqrt(Math.pow(e-this.elementInfo.x,2)+Math.pow(t-this.elementInfo.y,2)),r=Math.atan2(e-this.elementInfo.x,t-this.elementInfo.y);r=Math.PI*.5-r,r<0&&(r=Math.PI*2+r);for(var i=0;i<this.elementInfo.elements.length;i++){var s=this.elementInfo.elements[i];if(s.r>n&&r>=s.start&&r<s.end)return s}return null};var v=function(e,t,n,r,i,s){f.call(this,e,t,n,r,i,s)};v.prototype=new f,v.prototype.constructor=v,v.prototype.draw=function(e,t,n,r){var i=this.config.fontSize*2,s={x:0,y:n-i,width:t,height:i},o={x:0,y:0,width:t,height:this.config.fontSize*(this.config.title?4:1)},u=this.calculateRange(n-o.height-s.height),a={x:0,y:o.y+o.height,width:u.rangeTextWidth,height:n-s.height-o.height},f=N(e[0].slice(1),r,this.config.fontSize),l={x:t-f,y:o.y+o.height,width:f,height:n-s.height-o.height},c={x:a.x+a.width,y:o.y+o.height,width:t-a.width-l.width,height:n-a.height-o.height},h=0;r.beginPath(),r.strokeStyle=this.config.gridStrokeColor;for(var p=0;p<=this.config.numberCoordinateCount;p++){var d=u.start+p*u.stepSize,v=a.y+a.height-p*u.stepLength+.5;d==0?h=v:(r.moveTo(c.x,Math.floor(v)+.5),r.lineTo(c.x+c.width,Math.floor(v)+.5)),r.fillStyle=this.config.fontColor,r.fillText(d.toFixed(u.stepFix),a.x,v+this.config.fontSize/2)}r.stroke(),r.beginPath(),r.fillStyle="#000",r.strokeStyle="#000",r.moveTo(c.x,Math.floor(h)+.5),r.lineTo(c.x+c.width,Math.floor(h)+.5),r.stroke();var m=this.config.type!==undefined&&this.config.type.toLowerCase()=="area",g=e.length-1,y=c.width/(g-(m?1:0)),b=x(g),w=T(g);r.fillStyle=this.config.fontColor;for(p=1;p<e.length;p++)r.fillText(e[p][0],c.x+(p-.5)*y-r.measureText(e[p][0]).width/2,s.y+s.height*.75);var E,S,C;for(p=1;p<=g;p++){E=[],S=0,C=b[p-1];for(S=1;S<e.length;S++)E.push({x:c.x+S*y-(m?1:.5)*y,y:h-u.stepLength/u.stepSize*e[S][p],label:e[S][0],header:e[0][p],value:e[S][p]});for(S=0;S<E.length;S++)this.saveDotElementPos(E[S].x,E[S].y,this.config.circleRadius,C,E[S].label,E[S].header,E[S].value);if(m){r.save(),r.beginPath(),r.fillStyle=w[p-1];var k=E[0];r.moveTo(k.x,h);for(S=0;S<E.length;S++)k=E[S],r.lineTo(k.x,k.y);r.lineTo(k.x,h),r.closePath(),r.fill(),r.restore()}r.beginPath(),r.fillStyle=C,r.strokeStyle=C,r.lineWidth=2;for(S=1;S<E.length;S++)r.moveTo(E[S-1].x,E[S-1].y),r.lineTo(E[S].x,E[S].y);r.stroke()}this.drawHeaderIndicator(e[0].slice(1),b,l),this.drawTitle(o)},v.prototype.saveDotElementPos=function(e,t,n,r,i,s,o){this.elementInfo.elements.push({x:e,y:t,r:n,color:r,label:i,header:s,value:o})},v.prototype.findHoverElement=function(e,t){var n,r;for(var i=0;i<this.elementInfo.elements.length;i++){r=this.elementInfo.elements[i],n=Math.sqrt(Math.pow(r.x-e,2)+Math.pow(r.y-t,2));if(n<r.r*1.5)return r}return null},v.prototype.showTooltip=function(t){e(this.tooltipDiv).html('<p class="desc">'+t.label+'<br /><a style="color:'+t.color+'">'+t.header+": </a>"+t.value+"</p>");var n=t.y-e(this.tooltipDiv).height()-this.config.circleRadius*2,r=t.x-e(this.tooltipDiv).width()/2,i=this.calculateTooltipPosition(n,r);e(this.tooltipDiv).css({top:i.top,left:i.left}).show()};var m=function(e,t,n,r,i,s){a.call(this,e,t,n,r,i,s)};m.prototype=new a,m.prototype.constructor=m,m.prototype.showTooltip=function(t){e(this.tooltipDiv).html('<p class="desc">'+t.label+'<br /><a style="color:'+t.color+'">'+t.property+": </a>"+t.value+"</p>");var n=t.y-this.config.lineWidth*8,r=t.x-e(this.tooltipDiv).width()-10,i=this.calculateTooltipPosition(n,r);e(this.tooltipDiv).css({top:i.top,left:i.left}).show()},m.prototype.draw=function(t,n,r,i){var s={x:0,y:0,width:n,height:this.config.fontSize*(this.config.title?4:1)},o=e.map(t.slice(1),function(e){return e[0]}),u=N(o,i,this.config.fontSize),a={x:n-u,y:s.y+s.height,width:u,height:r-s.height},f={x:0,y:s.y+s.height,width:n-a.width,height:r-s.height},l=t[0].slice(1),c=N(l,i,this.config.fontSize),h=Math.floor(f.x+f.width/2)+.5,p=Math.floor(f.y+f.height/2)+.5,d=Math.min(f.width-2*c,f.height-3*this.config.fontSize)/2,v,m,g,y,b,w=l.length,E=Math.PI*2/w,S=Math.PI/2;i.strokeStyle=this.config.webGridStrokeColor,i.fillStyle="#000";for(v=0;v<w;v++)i.moveTo(h,p),b=v*E-S,g=Math.floor(Math.cos(b)*d+h)+.5,y=Math.floor(Math.sin(b)*d+p)+.5,i.lineTo(g,y),g>h?i.textAlign="left":g<h?i.textAlign="right":i.textAlign="center",i.fillText(l[v],g,y);i.stroke(),i.textAlign="left";var T=[],k,L,A;for(v=1;v<this.dataSheet.length;v++){A=this.dataSheet[v];for(m=1;m<A.length;m++)T.push(A[m])}L=C(this.config.webGridCount,d-this.config.fontSize,T,i);for(v=0;v<this.config.webGridCount;v++){k=L.stepLength*(v+1);for(m=0;m<w;m++)i.moveTo(Math.floor(Math.cos(m*E-S)*k+h)+.5,Math.floor(Math.sin(m*E-S)*k+p)+.5),i.lineTo(Math.floor(Math.cos((m+1)*E-S)*k+h)+.5,Math.floor(Math.sin((m+1)*E-S)*k+p)+.5)}i.stroke();var O=x(o.length),M;i.lineWidth=this.config.lineWidth;for(v=1;v<this.dataSheet.length;v++){A=this.dataSheet[v],i.strokeStyle=O[v-1],i.beginPath(),M=this.calculateNodePos(this.dataSheet[v].slice(1),L,E,S,h,p,O[v-1],A[0],l);for(m=0;m<M.length-1;m++)i.moveTo(M[m].x,M[m].y),i.lineTo(M[m+1].x,M[m+1].y);i.moveTo(M[M.length-1].x,M[M.length-1].y),i.lineTo(M[0].x,M[0].y),i.stroke()}this.drawHeaderIndicator(o,O,a),this.drawTitle(s)},m.prototype.calculateNodePos=function(e,t,n,r,i,s,o,u,a){var f=[],l,c,h;for(var p=0;p<e.length;p++)h=t.stepLength*e[p]/t.stepSize,l=Math.floor(Math.cos(p*n-r)*h+i)+.5,c=Math.floor(Math.sin(p*n-r)*h+s)+.5,f.push({x:l,y:c}),this.elementInfo.elements.push({x:l,y:c,color:o,label:u,property:a[p],value:e[p]});return f},m.prototype.findHoverElement=function(e,t){var n=this.config.lineWidth*4,r,i;for(var s=0;s<this.elementInfo.elements.length;s++){r=this.elementInfo.elements[s],i=Math.sqrt(Math.pow(r.x-e,2)+Math.pow(r.y-t,2));if(i<=n)return r}return null};var E=["#3366CC","#DC3912","#FF9900","#109618","#990099","#0099C6","DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300"],S=w(E,.5);e.extend(e.fn,{Bar:k(l,n),Column:k(c,n),Pie:k(h,r),Line:k(v,o),Radar:k(m,u),PolarArea:k(d,i),Doughnut:k(p,s)})})(jQuery);